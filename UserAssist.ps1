$i=0;gci HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist|%{$cl=$_.pschildname;(gp ($_.pspath+"\\count")).psobject.properties|?{$_.typenameofvalue -eq "system.byte[]" -and $_.name -match "^({|[A-Z]:\\)"}|%{$i++;$_|select @{Name="Path Type";Expression={if($_.name -match "^{"){"GUID Path"}else{"Drive Letter Path"}}},@{Name="Index";Expression={$i}},@{Name="File Path";Expression={($_.name.tochararray()|%{if($_-ge'A'-and$_-le'Z'){[char](($_-52)%26+65)}elseif($_-ge'a'-and$_-le'z'){[char](($_-84)%26+97)}else{$_}})-join ''}},@{Name="Last Execution Time";Expression={[DateTime]::FromFileTime([Convert]::ToInt64((($_.value[-5..-12]|%{"{0:X2}"-f$_})-join''),16))}},@{Name="Run Count";Expression={[Convert]::ToInt64((($_.value[7..4]|%{"{0:X2}"-f$_})-join''),16)}},@{Name="Focus Count";Expression={[Convert]::ToInt64((($_.value[11..8]|%{"{0:X2}"-f$_})-join''),16)}},@{Name="Total Focus Time (Seconds)";Expression={[Convert]::ToInt64((($_.value[15..12]|%{"{0:X2}"-f$_})-join''),16)/1000}},@{Name="File Class GUID";Expression={$cl}},@{Name="Encrypted Path";Expression={$_.name}}}}|ogv -t "By ShellbagSquad for pukytime"
